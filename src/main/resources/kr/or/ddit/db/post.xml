<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="post">


	<!-- resultType :데이터베이스 결과데이터를 객체에 로드하는 방법을 정의하는 엘리먼트 parameterType -->
	<select id="selectPostPageList" resultType="postVo"
		parameterType="pageVo">
		   select * from (
        select rownum rnum , a.* 
        from (
            select lpad('└RE :
            ',(level-1)*3, ' ')|| post_title, post.*, level
            from post
            where bor_id = #{bor_Id}
            start with post_idfather is null
            connect by prior post_id = post_idfather
            order siblings by post_id desc)a
            ) 
  	 	where rnum between #{page}*#{pageSize}-(#{pageSize}-1)
		and #{page}*#{pageSize}
	</select>


	<!--==============================================================================-->

	<!-- 게시글 삭제 쿼리 : 'Y'를 선택하면 '삭제되었습니다' 글이 나오게 -->
	<select id="postdelete" resultType="postVo">
		select * from post where post_del = 'Y'
	</select>
	
	
	<select id="getpostCnt" resultType="int">
		select count (*)
		from post
	</select>

	
	<insert id="insertPost" parameterType="boardVo">
			insert into post
				 values (post_id_seq.nextval,#{post_Title},#{post_Content},
		         #{bor_Id},#{post_Del},sysdate,#{post_Idfather},#{userId})
	</insert>
	
	<select id="selectPost" parameterType="String" resultType="postVo">
		select * from post where post_id = #{post_Id}
	</select>
	
</mapper>

























